@startuml
class "NonCopyable" as C_0001159823987743494688
class C_0001159823987743494688 {
}
class "Date" as C_0002032009232244826154
class C_0002032009232244826154 {
+Date() : void
+Date(int64_t microSec) : void
+Date(unsigned int year, unsigned int month, unsigned int day, unsigned int hour = 0, unsigned int minute = 0, unsigned int second = 0, unsigned int microSecond = 0) : void
{static} +date() : const Date
{static} +now() : const Date
{static} +timezoneOffset() : int64_t
+after(double second) const : const Date
+roundSecond() const : const Date
+roundDay() const : const Date
+~Date() : void
+operator==(const Date & date) const : bool
+operator!=(const Date & date) const : bool
+operator<(const Date & date) const : bool
+operator>(const Date & date) const : bool
+operator>=(const Date & date) const : bool
+operator<=(const Date & date) const : bool
+microSecondsSinceEpoch() const : int64_t
+secondsSinceEpoch() const : int64_t
+tmStruct() const : struct tm
+toFormattedString(bool showMicroseconds) const : std::string
+toCustomedFormattedString(const std::string & fmtStr, bool showMicroseconds = false) const : std::string
+toFormattedStringLocal(bool showMicroseconds) const : std::string
+toCustomedFormattedStringLocal(const std::string & fmtStr, bool showMicroseconds = false) const : std::string
+toDbStringLocal() const : std::string
+toDbString() const : std::string
{static} +fromDbStringLocal(const std::string & datetime) : Date
{static} +fromDbString(const std::string & datetime) : Date
+toCustomedFormattedString(const std::string & fmtStr, char * str, size_t len) const : void
+isSameSecond(const Date & date) const : bool
+swap(Date & that) : void
}
class "AsyncFileLogger" as C_0000630185754256426097
class C_0000630185754256426097 {
+output(const char * msg, const uint64_t len) : void
+flush() : void
+startLogging() : void
+setFileSizeLimit(uint64_t limit) : void
+setFileName(const std::string & baseName, const std::string & extName = ".log", const std::string & path = "./") : void
+~AsyncFileLogger() : void
+AsyncFileLogger() : void
}
class "AsyncFileLogger::LoggerFile" as C_0000923080849258138681
class C_0000923080849258138681 {
+LoggerFile(const std::string & filePath, const std::string & fileBaseName, const std::string & fileExtName) : void
+~LoggerFile() : void
+writeLog(const StringPtr buf) : void
+getLength() : uint64_t
+operator bool() const : bool
+flush() : void
}
class "MpscQueue<T>" as C_0000912667184903365399
class C_0000912667184903365399 {
+MpscQueue<T>() : void
+~MpscQueue<T>() : void
+enqueue(T && input) : void
+enqueue(const T & input) : void
+dequeue(T & output) : bool
+empty() : bool
}
class "MpscQueue<std::function<>>" as C_0000913287266699074255
class C_0000913287266699074255 {
}
class "EventLoop" as C_0001390130774830223499
class C_0001390130774830223499 {
+EventLoop() : void
+~EventLoop() : void
+loop() : void
+quit() : void
+assertInLoopThread() : void
+resetTimerQueue() : void
+resetAfterFork() : void
+isInLoopThread() const : bool
{static} +getEventLoopOfCurrentThread() : EventLoop *
+queueInLoop(const Func & f) : void
+queueInLoop(Func && f) : void
+runAt(const Date & time, const Func & cb) : TimerId
+runAt(const Date & time, Func && cb) : TimerId
+runAfter(double delay, const Func & cb) : TimerId
+runAfter(double delay, Func && cb) : TimerId
+runAfter(const std::chrono::duration<double> & delay, const Func & cb) : TimerId
+runAfter(const std::chrono::duration<double> & delay, Func && cb) : TimerId
+runEvery(double interval, const Func & cb) : TimerId
+runEvery(double interval, Func && cb) : TimerId
+runEvery(const std::chrono::duration<double> & interval, const Func & cb) : TimerId
+runEvery(const std::chrono::duration<double> & interval, Func && cb) : TimerId
+invalidateTimer(TimerId id) : void
+moveToCurrentThread() : void
+updateChannel(Channel * chl) : void
+removeChannel(Channel * chl) : void
+index() : size_t
+setIndex(size_t index) : void
+isRunning() : bool
+isCallingFunctions() : bool
+runOnQuit(Func && cb) : void
+runOnQuit(const Func & cb) : void
+runInLoop(Functor && f) : void
}
class "EventLoopThread" as C_0001280612521485369958
class C_0001280612521485369958 {
+EventLoopThread(const std::string & threadName = "EventLoopThread") : void
+~EventLoopThread() : void
+wait() : void
+getLoop() const : EventLoop *
+run() : void
}
class "EventLoopThreadPool" as C_0002061035340998974559
class C_0002061035340998974559 {
+EventLoopThreadPool() : void
+EventLoopThreadPool(size_t threadNum, const std::string & name = "EventLoopThreadPool") : void
+start() : void
+wait() : void
+size() : size_t
+getNextLoop() : EventLoop *
+getLoop(size_t id) : EventLoop *
+getLoops() const : std::vector<EventLoop *>
}
abstract "Poller" as C_0000300034150397884642
abstract C_0000300034150397884642 {
+Poller(EventLoop * loop) : void
+~Poller() : void
+assertInLoopThread() : void
{abstract} +poll(int timeoutMs, ChannelList * activeChannels) = 0 : void
{abstract} +updateChannel(Channel * channel) = 0 : void
{abstract} +removeChannel(Channel * channel) = 0 : void
+resetAfterFork() : void
{static} +newPoller(EventLoop * loop) : Poller *
}
class "TimerQueue" as C_0000607400095182694101
class C_0000607400095182694101 {
+TimerQueue(EventLoop * loop) : void
+~TimerQueue() : void
+addTimer(const TimerCallback & cb, const TimePoint & when, const TimeInterval & interval) : TimerId
+addTimer(TimerCallback && cb, const TimePoint & when, const TimeInterval & interval) : TimerId
+addTimerInLoop(const TimerPtr & timer) : void
+invalidateTimer(TimerId id) : void
+reset() : void
}
class "Channel" as C_0000764690828649606524
class C_0000764690828649606524 {
+Channel(EventLoop * loop, int fd) : void
+setReadCallback(const Channel::EventCallback & cb) : void
+setReadCallback(Channel::EventCallback && cb) : void
+setWriteCallback(const Channel::EventCallback & cb) : void
+setWriteCallback(Channel::EventCallback && cb) : void
+setCloseCallback(const Channel::EventCallback & cb) : void
+setCloseCallback(Channel::EventCallback && cb) : void
+setErrorCallback(const Channel::EventCallback & cb) : void
+setErrorCallback(Channel::EventCallback && cb) : void
+setEventCallback(const Channel::EventCallback & cb) : void
+setEventCallback(Channel::EventCallback && cb) : void
+fd() const : int
+events() const : int
+revents() const : int
+isNoneEvent() const : bool
+disableAll() : void
+remove() : void
+ownerLoop() : EventLoop *
+enableReading() : void
+disableReading() : void
+enableWriting() : void
+disableWriting() : void
+isWriting() const : bool
+isReading() const : bool
+updateEvents(int events) : void
+tie(const std::shared_ptr<void> & obj) : void
{static} +kNoneEvent : const int
{static} +kReadEvent : const int
{static} +kWriteEvent : const int
}
class "MsgBuffer" as C_0001289495020269537351
class C_0001289495020269537351 {
+MsgBuffer(size_t len = kBufferDefaultLength) : void
+peek() const : const char *
+beginWrite() const : const char *
+beginWrite() : char *
+peekInt8() const : uint8_t
+peekInt16() const : uint16_t
+peekInt32() const : uint32_t
+peekInt64() const : uint64_t
+read(size_t len) : std::string
+readInt8() : uint8_t
+readInt16() : uint16_t
+readInt32() : uint32_t
+readInt64() : uint64_t
+swap(MsgBuffer & buf) : void
+readableBytes() const : size_t
+writableBytes() const : size_t
+append(const MsgBuffer & buf) : void
+append(const char * buf, size_t len) : void
+append(const std::string & buf) : void
+appendInt8(const uint8_t b) : void
+appendInt16(const uint16_t s) : void
+appendInt32(const uint32_t i) : void
+appendInt64(const uint64_t l) : void
+addInFront(const char * buf, size_t len) : void
+addInFrontInt8(const uint8_t b) : void
+addInFrontInt16(const uint16_t s) : void
+addInFrontInt32(const uint32_t i) : void
+addInFrontInt64(const uint64_t l) : void
+retrieveAll() : void
+retrieve(size_t len) : void
+readFd(int fd, int * retErrno) : ssize_t
+retrieveUntil(const char * end) : void
+findCRLF() const : const char *
+ensureWritableBytes(size_t len) : void
+hasWritten(size_t len) : void
+unwrite(size_t offset) : void
+operator[](size_t offset) const : const char &
+operator[](size_t offset) : char &
+append(const char (&)[N] buf) : void
}
abstract "TaskQueue" as C_0000684873245997977544
abstract C_0000684873245997977544 {
{abstract} +runTaskInQueue(const std::function<void ()> & task) = 0 : void
{abstract} +runTaskInQueue(std::function<void ()> && task) = 0 : void
+getName() const : std::string
+syncTaskInQueue(const std::function<void ()> & task) : void
+~TaskQueue() : void
}
class "SerialTaskQueue" as C_0000634031134969193198
class C_0000634031134969193198 {
+runTaskInQueue(const std::function<void ()> & task) : void
+runTaskInQueue(std::function<void ()> && task) : void
+getName() const : std::string
+waitAllTasksFinished() : void
+SerialTaskQueue() : void
+SerialTaskQueue(const std::string & name) : void
+~SerialTaskQueue() : void
+isRuningTask() : bool
+getTaskCount() : size_t
+stop() : void
}
class "detail::FixedBuffer<int SIZE>" as C_0000111393647775817392
class C_0000111393647775817392 {
+FixedBuffer<SIZE>() : void
+~FixedBuffer<SIZE>() : void
+append(const char * buf, size_t len) : bool
+data() const : const char *
+length() const : int
+current() : char *
+avail() const : int
+add(size_t len) : void
+reset() : void
+zeroBuffer() : void
+debugString() : const char *
+setCookie(void (*)() cookie) : void
+toString() const : std::string
}
class "detail::FixedBuffer<detail::kSmallBuffer>" as C_0000510041652600390686
class C_0000510041652600390686 {
}
class "detail::FixedBuffer<4000>" as C_0001754247125147083756
class C_0001754247125147083756 {
+FixedBuffer() : void
+~FixedBuffer() : void
+append(const char * buf, size_t len) : bool
+data() const : const char *
+length() const : int
+current() : char *
+avail() const : int
+add(size_t len) : void
+reset() : void
+zeroBuffer() : void
+debugString() : const char *
+setCookie(void (*)() cookie) : void
+toString() const : std::string
}
class "detail::FixedBuffer<4000000>" as C_0001042478360162272930
class C_0001042478360162272930 {
+FixedBuffer() : void
+~FixedBuffer() : void
+append(const char * buf, size_t len) : bool
+data() const : const char *
+length() const : int
+current() : char *
+avail() const : int
+add(size_t len) : void
+reset() : void
+zeroBuffer() : void
+debugString() : const char *
+setCookie(void (*)() cookie) : void
+toString() const : std::string
}
class "LogStream" as C_0001930690020065325250
class C_0001930690020065325250 {
+operator<<(bool v) : LogStream::self &
+operator<<(short ) : LogStream::self &
+operator<<(unsigned short ) : LogStream::self &
+operator<<(int ) : LogStream::self &
+operator<<(unsigned int ) : LogStream::self &
+operator<<(long ) : LogStream::self &
+operator<<(unsigned long ) : LogStream::self &
+operator<<(const long long & ) : LogStream::self &
+operator<<(const unsigned long long & ) : LogStream::self &
+operator<<(const void * ) : LogStream::self &
+operator<<(float & v) : LogStream::self &
+operator<<(const double & ) : LogStream::self &
+operator<<(const long double & v) : LogStream::self &
+operator<<(char v) : LogStream::self &
+operator<<(char * str) : LogStream::self &
+operator<<(const char * str) : LogStream::self &
+operator<<(const unsigned char * str) : LogStream::self &
+operator<<(const std::string & v) : LogStream::self &
+append(const char * data, size_t len) : void
+bufferData() const : const char *
+bufferLength() const : size_t
+resetBuffer() : void
+operator<<(const char (&)[N] buf) : LogStream::self &
}
class "Fmt" as C_0002131890502232898697
class C_0002131890502232898697 {
+data() const : const char *
+length() const : int
+Fmt(const char * fmt, T val) : void
}
class "Logger" as C_0002053752992472264214
class C_0002053752992472264214 {
+Logger(Logger::SourceFile file, int line) : void
+Logger(Logger::SourceFile file, int line, Logger::LogLevel level) : void
+Logger(Logger::SourceFile file, int line, bool isSysErr) : void
+Logger(Logger::SourceFile file, int line, Logger::LogLevel level, const char * func) : void
+~Logger() : void
+setIndex(int index) : Logger &
+stream() : LogStream &
{static} +setOutputFunction(std::function<void (const char *,const uint64_t)> outputFunc, std::function<void ()> flushFunc, int index = -1) : void
{static} +setLogLevel(Logger::LogLevel level) : void
{static} +logLevel() : Logger::LogLevel
}
enum "Logger::LogLevel" as C_0001184349029950147049
enum C_0001184349029950147049 {
kTrace
kDebug
kInfo
kWarn
kError
kFatal
kNumberOfLogLevels
}
class "Logger::SourceFile" as C_0002198968118661318449
class C_0002198968118661318449 {
+SourceFile(const char * filename) : void
+SourceFile(const char (&)[N] arr) : void
+data_ : const char *
+size_ : int
}
class "RawLogger" as C_0000716430590791918928
class C_0000716430590791918928 {
+~RawLogger() : void
+setIndex(int index) : RawLogger &
+stream() : LogStream &
}
class "ConcurrentTaskQueue" as C_0000295101274428145462
class C_0000295101274428145462 {
+ConcurrentTaskQueue(size_t threadNum, const std::string & name) : void
+runTaskInQueue(const std::function<void ()> & task) : void
+runTaskInQueue(std::function<void ()> && task) : void
+getName() const : std::string
+getTaskCount() : size_t
+stop() : void
+~ConcurrentTaskQueue() : void
}
class "InetAddress" as C_0001897340460211641725
class C_0001897340460211641725 {
+InetAddress(uint16_t port = 0, bool loopbackOnly = false, bool ipv6 = false) : void
+InetAddress(const std::string & ip, uint16_t port, bool ipv6 = false) : void
+InetAddress(const struct sockaddr_in & addr) : void
+InetAddress(const struct sockaddr_in6 & addr) : void
+family() const : sa_family_t
+toIp() const : std::string
+toIpPort() const : std::string
+toPort() const : uint16_t
+isIpV6() const : bool
+isIntranetIp() const : bool
+isLoopbackIp() const : bool
+getSockAddr() const : const struct sockaddr *
+setSockAddrInet6(const struct sockaddr_in6 & addr6) : void
+ipNetEndian() const : uint32_t
+ip6NetEndian() const : const uint32_t *
+portNetEndian() const : uint16_t
+setPortNetEndian(uint16_t port) : void
+isUnspecified() const : bool
}
class "InetAddress::(anonymous_2030796)" as C_0001238571308552245455
class C_0001238571308552245455 {
+addr_ : struct sockaddr_in
+addr6_ : struct sockaddr_in6
}
enum "SSLError" as C_0000434245188016003403
enum C_0000434245188016003403 {
kSSLHandshakeError
kSSLInvalidCertificate
}
abstract "TcpConnection" as C_0002230624932100089526
abstract C_0002230624932100089526 {
+TcpConnection() = default : void
+~TcpConnection() : void
{abstract} +send(const char * msg, size_t len) = 0 : void
{abstract} +send(const void * msg, size_t len) = 0 : void
{abstract} +send(const std::string & msg) = 0 : void
{abstract} +send(std::string && msg) = 0 : void
{abstract} +send(const MsgBuffer & buffer) = 0 : void
{abstract} +send(MsgBuffer && buffer) = 0 : void
{abstract} +send(const std::shared_ptr<std::string> & msgPtr) = 0 : void
{abstract} +send(const std::shared_ptr<MsgBuffer> & msgPtr) = 0 : void
{abstract} +sendFile(const char * fileName, size_t offset = 0, size_t length = 0) = 0 : void
{abstract} +sendFile(const wchar_t * fileName, size_t offset = 0, size_t length = 0) = 0 : void
{abstract} +sendStream(std::function<std::size_t (char *,std::size_t)> callback) = 0 : void
{abstract} +localAddr() const = 0 : const InetAddress &
{abstract} +peerAddr() const = 0 : const InetAddress &
{abstract} +connected() const = 0 : bool
{abstract} +disconnected() const = 0 : bool
{abstract} +getRecvBuffer() = 0 : MsgBuffer *
{abstract} +setHighWaterMarkCallback(const HighWaterMarkCallback & cb, size_t markLen) = 0 : void
{abstract} +setTcpNoDelay(bool on) = 0 : void
{abstract} +shutdown() = 0 : void
{abstract} +forceClose() = 0 : void
{abstract} +getLoop() = 0 : EventLoop *
+setContext(const std::shared_ptr<void> & context) : void
+setContext(std::shared_ptr<void> && context) : void
+hasContext() const : bool
+clearContext() : void
{abstract} +keepAlive() = 0 : void
{abstract} +isKeepAlive() = 0 : bool
{abstract} +bytesSent() const = 0 : size_t
{abstract} +bytesReceived() const = 0 : size_t
{abstract} +isSSLConnection() const = 0 : bool
{abstract} +startClientEncryption(std::function<void ()> callback, bool useOldTLS = false, bool validateCert = true, std::string hostname = "", const std::vector<std::pair<std::string,std::string>> & sslConfCmds = =
            {}) = 0 : void
{abstract} +startServerEncryption(const std::shared_ptr<SSLContext> & ctx, std::function<void ()> callback) = 0 : void
+getContext() : std::shared_ptr<T>
}
class "TcpClient" as C_0001156367011091191681
class C_0001156367011091191681 {
+TcpClient(EventLoop * loop, const InetAddress & serverAddr, const std::string & nameArg) : void
+~TcpClient() : void
+connect() : void
+disconnect() : void
+stop() : void
+connection() const : TcpConnectionPtr
+getLoop() const : EventLoop *
+retry() const : bool
+enableRetry() : void
+name() const : const std::string &
+setConnectionCallback(const ConnectionCallback & cb) : void
+setConnectionCallback(ConnectionCallback && cb) : void
+setConnectionErrorCallback(const ConnectionErrorCallback & cb) : void
+setMessageCallback(const RecvMessageCallback & cb) : void
+setMessageCallback(RecvMessageCallback && cb) : void
+setWriteCompleteCallback(const WriteCompleteCallback & cb) : void
+setWriteCompleteCallback(WriteCompleteCallback && cb) : void
+setSSLErrorCallback(const SSLErrorCallback & cb) : void
+setSSLErrorCallback(SSLErrorCallback && cb) : void
+enableSSL(bool useOldTLS = false, bool validateCert = true, std::string hostname = "", const std::vector<std::pair<std::string,std::string>> & sslConfCmds = = {}, const std::string & certPath = "", const std::string & keyPath = "", const std::string & caPath = "") : void
}
class "TcpClient::IgnoreSigPipe" as C_0002033458902174399063
class C_0002033458902174399063 {
+IgnoreSigPipe() : void
}
class "Connector" as C_0001706043459252151324
class C_0001706043459252151324 {
+Connector(EventLoop * loop, const InetAddress & addr, bool retry = true) : void
+Connector(EventLoop * loop, InetAddress && addr, bool retry = true) : void
+setNewConnectionCallback(const Connector::NewConnectionCallback & cb) : void
+setNewConnectionCallback(Connector::NewConnectionCallback && cb) : void
+setErrorCallback(const Connector::ConnectionErrorCallback & cb) : void
+setErrorCallback(Connector::ConnectionErrorCallback && cb) : void
+serverAddress() const : const InetAddress &
+start() : void
+restart() : void
+stop() : void
}
enum "Connector::Status" as C_0002045450139033818398
enum C_0002045450139033818398 {
Disconnected
Connecting
Connected
}
class "TimingWheel" as C_0000964465843177067305
class C_0000964465843177067305 {
+TimingWheel(EventLoop * loop, size_t maxTimeout, float ticksInterval = 1.0, size_t bucketsNumPerWheel = 100) : void
+insertEntry(size_t delay, EntryPtr entryPtr) : void
+insertEntryInloop(size_t delay, EntryPtr entryPtr) : void
+getLoop() : EventLoop *
+~TimingWheel() : void
}
class "TimingWheel::CallbackEntry" as C_0001504852334691167098
class C_0001504852334691167098 {
+CallbackEntry(std::function<void ()> cb) : void
+~CallbackEntry() : void
}
enum "SSLStatus" as C_0001515554933771522998
enum C_0001515554933771522998 {
Handshaking
Connecting
Connected
DisConnecting
DisConnected
}
class "TcpConnectionImpl" as C_0000920759514274339356
class C_0000920759514274339356 {
+TcpConnectionImpl(EventLoop * loop, int socketfd, const InetAddress & localAddr, const InetAddress & peerAddr) : void
+TcpConnectionImpl(EventLoop * loop, int socketfd, const InetAddress & localAddr, const InetAddress & peerAddr, const std::shared_ptr<SSLContext> & ctxPtr, bool isServer = true, bool validateCert = true, const std::string & hostname = "") : void
+~TcpConnectionImpl() : void
+send(const char * msg, size_t len) : void
+send(const void * msg, size_t len) : void
+send(const std::string & msg) : void
+send(std::string && msg) : void
+send(const MsgBuffer & buffer) : void
+send(MsgBuffer && buffer) : void
+send(const std::shared_ptr<std::string> & msgPtr) : void
+send(const std::shared_ptr<MsgBuffer> & msgPtr) : void
+sendFile(const char * fileName, size_t offset = 0, size_t length = 0) : void
+sendFile(const wchar_t * fileName, size_t offset = 0, size_t length = 0) : void
+sendStream(std::function<std::size_t (char *,std::size_t)> callback) : void
+localAddr() const : const InetAddress &
+peerAddr() const : const InetAddress &
+connected() const : bool
+disconnected() const : bool
+getRecvBuffer() : MsgBuffer *
+setHighWaterMarkCallback(const HighWaterMarkCallback & cb, size_t markLen) : void
+keepAlive() : void
+isKeepAlive() : bool
+setTcpNoDelay(bool on) : void
+shutdown() : void
+forceClose() : void
+getLoop() : EventLoop *
+bytesSent() const : size_t
+bytesReceived() const : size_t
+startClientEncryption(std::function<void ()> callback, bool useOldTLS = false, bool validateCert = true, std::string hostname = "", const std::vector<std::pair<std::string,std::string>> & sslConfCmds = =
            {}) : void
+startServerEncryption(const std::shared_ptr<SSLContext> & ctx, std::function<void ()> callback) : void
+isSSLConnection() const : bool
}
class "TcpConnectionImpl::KickoffEntry" as C_0000054046898195558381
class C_0000054046898195558381 {
+KickoffEntry(const std::weak_ptr<TcpConnection> & conn) : void
+reset() : void
+~KickoffEntry() : void
}
class "TcpConnectionImpl::BufferNode" as C_0000943181451128697972
class C_0000943181451128697972 {
+isFile() const : bool
+~BufferNode() : void
+sendFd_ : int
+offset_ : off_t
+fileBytesToSend_ : ssize_t
+streamCallback_ : std::function<std::size_t (char *,std::size_t)>
+nDataWritten_ : std::size_t
+msgBuffer_ : std::shared_ptr<MsgBuffer>
}
enum "TcpConnectionImpl::ConnStatus" as C_0000198777833674414676
enum C_0000198777833674414676 {
Disconnected
Connecting
Connected
Disconnecting
}
class "TcpConnectionImpl::SSLEncryption" as C_0001847734957165426408
class C_0001847734957165426408 {
+statusOfSSL_ : SSLStatus
+sslCtxPtr_ : std::shared_ptr<SSLContext>
+sslPtr_ : std::unique_ptr<SSLConn>
+sendBufferPtr_ : std::unique_ptr<std::array<char,8192>>
+isServer_ : bool
+isUpgrade_ : bool
+upgradeCallback_ : std::function<void ()>
+hostname_ : std::string
}
class "Socket" as C_0000971024972307079851
class C_0000971024972307079851 {
{static} +createNonblockingSocketOrDie(int family) : int
{static} +getSocketError(int sockfd) : int
{static} +connect(int sockfd, const InetAddress & addr) : int
{static} +isSelfConnect(int sockfd) : bool
+Socket(int sockfd) : void
+~Socket() : void
+bindAddress(const InetAddress & localaddr) : void
+listen() : void
+accept(InetAddress * peeraddr) : int
+closeWrite() : void
+read(char * buffer, uint64_t len) : int
+fd() : int
{static} +getLocalAddr(int sockfd) : struct sockaddr_in6
{static} +getPeerAddr(int sockfd) : struct sockaddr_in6
+setTcpNoDelay(bool on) : void
+setReuseAddr(bool on) : void
+setReusePort(bool on) : void
+setKeepAlive(bool on) : void
+getSocketError() : int
{static} +setNonBlockAndCloseOnExec(int sockfd) : void
}
class "SSLContext" as C_0000626107303889580949
class C_0000626107303889580949 {
}
class "SSLConn" as C_0001248784923817560723
class C_0001248784923817560723 {
}
class "TcpServer" as C_0001423170502760786790
class C_0001423170502760786790 {
+TcpServer(EventLoop * loop, const InetAddress & address, const std::string & name, bool reUseAddr = true, bool reUsePort = true) : void
+~TcpServer() : void
+start() : void
+stop() : void
+setIoLoopNum(size_t num) : void
+setIoLoopThreadPool(const std::shared_ptr<EventLoopThreadPool> & pool) : void
+setRecvMessageCallback(const RecvMessageCallback & cb) : void
+setRecvMessageCallback(RecvMessageCallback && cb) : void
+setConnectionCallback(const ConnectionCallback & cb) : void
+setConnectionCallback(ConnectionCallback && cb) : void
+setWriteCompleteCallback(const WriteCompleteCallback & cb) : void
+setWriteCompleteCallback(WriteCompleteCallback && cb) : void
+name() const : const std::string &
+ipPort() const : const std::string
+address() const : const InetAddress &
+getLoop() const : EventLoop *
+getIoLoops() const : std::vector<EventLoop *>
+kickoffIdleConnections(size_t timeout) : void
+enableSSL(const std::string & certPath, const std::string & keyPath, bool useOldTLS = false, const std::vector<std::pair<std::string,std::string>> & sslConfCmds = = {}, const std::string & caPath = "") : void
}
class "InetAddress::(anonymous_2030836)" as C_0000741797986785144168
class C_0000741797986785144168 {
+addr_ : struct sockaddr_in
+addr6_ : struct sockaddr_in6
}
class "Acceptor" as C_0000184886692180276257
class C_0000184886692180276257 {
+Acceptor(EventLoop * loop, const InetAddress & addr, bool reUseAddr = true, bool reUsePort = true) : void
+~Acceptor() : void
+addr() const : const InetAddress &
+setNewConnectionCallback(const NewConnectionCallback & cb) : void
+listen() : void
}
class "TcpServer::IgnoreSigPipe" as C_0001829426703641465340
class C_0001829426703641465340 {
+IgnoreSigPipe() : void
}
class "T" as C_0000394452884449343416
class C_0000394452884449343416 {
+T(const char * str, unsigned int len) : void
+str_ : const char *
+len_ : const unsigned int
}
class "Timer" as C_0002026475275429760163
class C_0002026475275429760163 {
+Timer(const TimerCallback & cb, const TimePoint & when, const TimeInterval & interval) : void
+Timer(TimerCallback && cb, const TimePoint & when, const TimeInterval & interval) : void
+~Timer() : void
+run() const : void
+restart(const TimePoint & now) : void
+operator<(const Timer & t) const : bool
+operator>(const Timer & t) const : bool
+when() const : const TimePoint &
+isRepeat() : bool
+id() : TimerId
}
class "TimerPtrComparer" as C_0000157340721173102239
class C_0000157340721173102239 {
+operator()(const TimerPtr & x, const TimerPtr & y) const : bool
}
class "InetAddress::(anonymous_1188166)" as C_0000253546837558644771
class C_0000253546837558644771 {
+addr_ : struct sockaddr_in
+addr6_ : struct sockaddr_in6
}
C_0000630185754256426097 o-- C_0000923080849258138681 : #loggerFilePtr_
C_0001159823987743494688 <|-- C_0000630185754256426097
C_0000923080849258138681 o-- C_0002032009232244826154 : #creationDate_
C_0000923080849258138681 --+ C_0000630185754256426097
C_0001159823987743494688 <|-- C_0000923080849258138681
C_0001159823987743494688 <|-- C_0000912667184903365399
C_0000913287266699074255 ..|> C_0000912667184903365399
C_0001390130774830223499 ..> C_0002032009232244826154
C_0001390130774830223499 ..> C_0000764690828649606524
C_0001390130774830223499 o-- C_0000300034150397884642 : -poller_
C_0001390130774830223499 --> C_0000764690828649606524 : -activeChannels_
C_0001390130774830223499 --> C_0000764690828649606524 : -currentActiveChannel_
C_0001390130774830223499 o-- C_0000913287266699074255 : -funcs_
C_0001390130774830223499 o-- C_0000607400095182694101 : -timerQueue_
C_0001390130774830223499 o-- C_0000913287266699074255 : -funcsOnQuit_
C_0001390130774830223499 o-- C_0000764690828649606524 : -wakeupChannelPtr_
C_0001390130774830223499 --> C_0001390130774830223499 : -threadLocalLoopPtr_
C_0001159823987743494688 <|-- C_0001390130774830223499
C_0001280612521485369958 --> C_0001390130774830223499 : -loop_
C_0001280612521485369958 o-- C_0001390130774830223499 : -promiseForLoopPointer_
C_0001159823987743494688 <|-- C_0001280612521485369958
C_0002061035340998974559 o-- C_0001280612521485369958 : -loopThreadVector_
C_0001159823987743494688 <|-- C_0002061035340998974559
C_0000300034150397884642 ..> C_0001390130774830223499
C_0000300034150397884642 ..> C_0000764690828649606524
C_0000300034150397884642 --> C_0001390130774830223499 : -ownerLoop_
C_0001159823987743494688 <|-- C_0000300034150397884642
C_0000607400095182694101 ..> C_0001390130774830223499
C_0000607400095182694101 ..> C_0002026475275429760163
C_0000607400095182694101 --> C_0001390130774830223499 : #loop_
C_0000607400095182694101 --> C_0000764690828649606524 : #timerfdChannelPtr_
C_0000607400095182694101 o-- C_0002026475275429760163 : #timers_
C_0000607400095182694101 o-- C_0000157340721173102239 : #timers_
C_0001159823987743494688 <|-- C_0000607400095182694101
C_0000764690828649606524 ..> C_0001390130774830223499
C_0000764690828649606524 --> C_0001390130774830223499 : -loop_
C_0000764690828649606524 <.. C_0001390130774830223499 : +<<friend>>
C_0001159823987743494688 <|-- C_0000764690828649606524
C_0001159823987743494688 <|-- C_0000684873245997977544
C_0000634031134969193198 o-- C_0001280612521485369958 : #loopThread_
C_0000684873245997977544 <|-- C_0000634031134969193198
C_0001159823987743494688 <|-- C_0000111393647775817392
C_0000510041652600390686 ..|> C_0000111393647775817392
C_0001754247125147083756 ..|> C_0000111393647775817392
C_0001159823987743494688 <|-- C_0001754247125147083756
C_0001042478360162272930 ..|> C_0000111393647775817392
C_0001159823987743494688 <|-- C_0001042478360162272930
C_0001930690020065325250 o-- C_0000510041652600390686 : -buffer_
C_0001159823987743494688 <|-- C_0001930690020065325250
C_0002053752992472264214 ..> C_0002198968118661318449
C_0002053752992472264214 ..> C_0001184349029950147049
C_0002053752992472264214 o-- C_0001930690020065325250 : #logStream_
C_0002053752992472264214 o-- C_0002032009232244826154 : #date_
C_0002053752992472264214 o-- C_0002198968118661318449 : #sourceFile_
C_0002053752992472264214 o-- C_0001184349029950147049 : #level_
C_0002053752992472264214 <.. C_0000716430590791918928 : +<<friend>>
C_0001159823987743494688 <|-- C_0002053752992472264214
C_0001184349029950147049 --+ C_0002053752992472264214
C_0002198968118661318449 --+ C_0002053752992472264214
C_0000716430590791918928 o-- C_0001930690020065325250 : -logStream_
C_0001159823987743494688 <|-- C_0000716430590791918928
C_0000684873245997977544 <|-- C_0000295101274428145462
C_0001897340460211641725 o-- C_0001238571308552245455
C_0001238571308552245455 --+ C_0001897340460211641725
C_0002230624932100089526 ..> C_0001289495020269537351
C_0002230624932100089526 ..> C_0000626107303889580949
C_0001156367011091191681 ..> C_0001390130774830223499
C_0001156367011091191681 ..> C_0001897340460211641725
C_0001156367011091191681 ..> C_0002230624932100089526
C_0001156367011091191681 ..> C_0001289495020269537351
C_0001156367011091191681 ..> C_0000434245188016003403
C_0001156367011091191681 --> C_0001390130774830223499 : -loop_
C_0001156367011091191681 o-- C_0001706043459252151324 : -connector_
C_0001156367011091191681 --> C_0002230624932100089526 : -connectionCallback_
C_0001156367011091191681 --> C_0002230624932100089526 : -messageCallback_
C_0001156367011091191681 --> C_0001289495020269537351 : -messageCallback_
C_0001156367011091191681 --> C_0002230624932100089526 : -writeCompleteCallback_
C_0001156367011091191681 ..> C_0000434245188016003403 : -sslErrorCallback_
C_0001156367011091191681 o-- C_0002230624932100089526 : -connection_
C_0001156367011091191681 --> C_0000626107303889580949 : -sslCtxPtr_
C_0001156367011091191681 --> C_0002033458902174399063 : -initObj
C_0001159823987743494688 <|-- C_0001156367011091191681
C_0002033458902174399063 --+ C_0001156367011091191681
C_0001706043459252151324 ..> C_0001390130774830223499
C_0001706043459252151324 ..> C_0001897340460211641725
C_0001706043459252151324 --> C_0000764690828649606524 : -channelPtr_
C_0001706043459252151324 --> C_0001390130774830223499 : -loop_
C_0001706043459252151324 o-- C_0001897340460211641725 : -serverAddr_
C_0001706043459252151324 o-- C_0002045450139033818398 : -status_
C_0001159823987743494688 <|-- C_0001706043459252151324
C_0002045450139033818398 --+ C_0001706043459252151324
C_0000964465843177067305 ..> C_0001390130774830223499
C_0000964465843177067305 --> C_0001390130774830223499 : -loop_
C_0001504852334691167098 --+ C_0000964465843177067305
C_0000920759514274339356 ..> C_0001390130774830223499
C_0000920759514274339356 ..> C_0001897340460211641725
C_0000920759514274339356 ..> C_0000626107303889580949
C_0000920759514274339356 ..> C_0001289495020269537351
C_0000920759514274339356 ..> C_0002230624932100089526
C_0000920759514274339356 ..> C_0000964465843177067305
C_0000920759514274339356 ..> C_0000434245188016003403
C_0000920759514274339356 ..> C_0000943181451128697972
C_0000920759514274339356 --> C_0000054046898195558381 : -kickoffEntry_
C_0000920759514274339356 --> C_0000964465843177067305 : -timingWheelWeakPtr_
C_0000920759514274339356 o-- C_0002032009232244826154 : -lastTimingWheelUpdateTime_
C_0000920759514274339356 --> C_0001390130774830223499 : #loop_
C_0000920759514274339356 o-- C_0000764690828649606524 : #ioChannelPtr_
C_0000920759514274339356 o-- C_0000971024972307079851 : #socketPtr_
C_0000920759514274339356 o-- C_0001289495020269537351 : #readBuffer_
C_0000920759514274339356 o-- C_0000943181451128697972 : #writeBufferList_
C_0000920759514274339356 o-- C_0001897340460211641725 : #localAddr_
C_0000920759514274339356 o-- C_0001897340460211641725 : #peerAddr_
C_0000920759514274339356 o-- C_0000198777833674414676 : #status_
C_0000920759514274339356 --> C_0002230624932100089526 : #recvMsgCallback_
C_0000920759514274339356 --> C_0001289495020269537351 : #recvMsgCallback_
C_0000920759514274339356 --> C_0002230624932100089526 : #connectionCallback_
C_0000920759514274339356 --> C_0002230624932100089526 : #closeCallback_
C_0000920759514274339356 --> C_0002230624932100089526 : #writeCompleteCallback_
C_0000920759514274339356 --> C_0002230624932100089526 : #highWaterMarkCallback_
C_0000920759514274339356 ..> C_0000434245188016003403 : #sslErrorCallback_
C_0000920759514274339356 o-- C_0001847734957165426408 : -sslEncryptionPtr_
C_0000920759514274339356 <.. C_0001156367011091191681 : +<<friend>>
C_0000920759514274339356 <.. C_0001423170502760786790 : +<<friend>>
C_0002230624932100089526 <|-- C_0000920759514274339356
C_0001159823987743494688 <|-- C_0000920759514274339356
C_0000054046898195558381 ..> C_0002230624932100089526
C_0000054046898195558381 --> C_0002230624932100089526 : -conn_
C_0000054046898195558381 --+ C_0000920759514274339356
C_0000943181451128697972 --> C_0001289495020269537351 : +msgBuffer_
C_0000943181451128697972 --+ C_0000920759514274339356
C_0000198777833674414676 --+ C_0000920759514274339356
C_0001847734957165426408 o-- C_0001515554933771522998 : +statusOfSSL_
C_0001847734957165426408 --> C_0000626107303889580949 : +sslCtxPtr_
C_0001847734957165426408 o-- C_0001248784923817560723 : +sslPtr_
C_0001847734957165426408 --+ C_0000920759514274339356
C_0000971024972307079851 ..> C_0001897340460211641725
C_0001159823987743494688 <|-- C_0000971024972307079851
C_0001423170502760786790 ..> C_0001390130774830223499
C_0001423170502760786790 ..> C_0001897340460211641725
C_0001423170502760786790 ..> C_0002061035340998974559
C_0001423170502760786790 ..> C_0002230624932100089526
C_0001423170502760786790 ..> C_0001289495020269537351
C_0001423170502760786790 --> C_0001390130774830223499 : -loop_
C_0001423170502760786790 o-- C_0000184886692180276257 : -acceptorPtr_
C_0001423170502760786790 o-- C_0002230624932100089526 : -connSet_
C_0001423170502760786790 --> C_0002230624932100089526 : -recvMessageCallback_
C_0001423170502760786790 --> C_0001289495020269537351 : -recvMessageCallback_
C_0001423170502760786790 --> C_0002230624932100089526 : -connectionCallback_
C_0001423170502760786790 --> C_0002230624932100089526 : -writeCompleteCallback_
C_0001423170502760786790 o-- C_0000964465843177067305 : -timingWheelMap_
C_0001423170502760786790 --> C_0002061035340998974559 : -loopPoolPtr_
C_0001423170502760786790 o-- C_0001829426703641465340 : -initObj
C_0001423170502760786790 --> C_0000626107303889580949 : -sslCtxPtr_
C_0001159823987743494688 <|-- C_0001423170502760786790
C_0000741797986785144168 --+ C_0001897340460211641725
C_0000184886692180276257 ..> C_0001390130774830223499
C_0000184886692180276257 ..> C_0001897340460211641725
C_0000184886692180276257 o-- C_0000971024972307079851 : #sock_
C_0000184886692180276257 o-- C_0001897340460211641725 : #addr_
C_0000184886692180276257 --> C_0001390130774830223499 : #loop_
C_0000184886692180276257 --> C_0001897340460211641725 : #newConnectionCallback_
C_0000184886692180276257 o-- C_0000764690828649606524 : #acceptChannel_
C_0001159823987743494688 <|-- C_0000184886692180276257
C_0001829426703641465340 --+ C_0001423170502760786790
C_0001159823987743494688 <|-- C_0002026475275429760163
C_0000157340721173102239 ..> C_0002026475275429760163
C_0000253546837558644771 --+ C_0001897340460211641725
@enduml
